{"file":"multi-select-dropdown2.js","mappings":"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","names":[],"sources":["src/components/design-system/multi-select-dropdown/multi-select-dropdown.scss?tag=multi-select-dropdown&encapsulation=shadow","src/components/design-system/multi-select-dropdown/multi-select-dropdown.tsx"],"sourcesContent":["@import '../../../common/styles/variables.scss';\n\n:host {\n  display: block;\n  width: inherit;\n  @include default-css-variables;\n}\n\n.dropdown {\n  display: inline-block;\n  width: 100%;\n  position: relative;\n  .dropdown-label {\n    display: flex;\n    align-items: center;\n    gap: 0.25rem;\n    color: var(--nylas-base-800);\n  }\n}\n\n.dropbtn {\n  width: inherit;\n  height: 48px;\n  color: black;\n  padding: 0.5rem;\n  font-size: 1rem;\n  cursor: pointer;\n  display: flex;\n  gap: 0.5rem;\n  justify-content: space-between;\n  align-items: center;\n  background: transparent;\n  border: 1px solid var(--nylas-base-200);\n  border-radius: var(--nylas-border-radius-2x);\n  &.focus {\n    background: transparent;\n  }\n  &:hover,\n  &:active {\n    border: 1px solid var(--nylas-primary);\n  }\n  &:active {\n    outline: 2px solid var(--nylas-primary);\n  }\n  span {\n    &.open {\n      transform: rotate(90deg);\n    }\n    &.closed {\n      transform: rotate(270deg);\n    }\n  }\n}\n\n.dropdown-content {\n  display: block;\n  margin-top: 0.5rem;\n  background-color: var(--nylas-base-0);\n  width: 100%;\n  max-height: 336px;\n  overflow: auto;\n  border: 1px solid #ddd;\n  z-index: 1;\n  border-radius: 4px;\n  position: absolute;\n  box-shadow: 0px 4px 6px -2px #0000000d;\n  box-shadow: 0px 10px 15px -3px #0000001a;\n}\n\n.dropdown-content ul {\n  padding: 0;\n  list-style-type: none;\n  color: var(--nylas-base-900);\n  max-height: 336px;\n  li {\n    padding: 16px, 12px, 16px, 12px;\n    color: black;\n    padding: 12px 16px;\n    text-decoration: none;\n    display: block;\n    font-family: inherit;\n    font-size: 14px;\n    font-weight: 400;\n    line-height: 20px;\n    letter-spacing: 0px;\n    text-align: left;\n    cursor: pointer;\n    &:hover,\n    &:focus {\n      background-color: var(--nylas-base-100);\n    }\n    label {\n      display: flex;\n      align-items: center;\n      gap: 0.5rem;\n      input {\n        margin: 0;\n      }\n    }\n  }\n}\n\n.selected-options {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n  padding: 0.5rem 0;\n  margin-top: 0.25rem;\n  background: var(--nylas-base-0);\n  .selected-option {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 4px 8px;\n    border-radius: var(--nylas-border-radius-2x);\n    background: var(--nylas-base-100);\n    color: var(--nylas-base-800);\n    font-size: 16px;\n    font-weight: 500;\n    line-height: 1.5rem;\n    letter-spacing: 0.5px;\n    button {\n      background: transparent;\n      border: none;\n      cursor: pointer;\n      padding: 0;\n      &:hover {\n        color: var(--nylas-primary);\n      }\n    }\n  }\n}\n","import { debug } from '@/utils/utils';\nimport { Component, Element, Event, EventEmitter, Host, Listen, Prop, State, h } from '@stencil/core';\n\ninterface DropdownOption {\n  label: string;\n  value: string;\n  selected?: boolean; // Add a selected flag to each option\n}\n\n@Component({\n  tag: 'multi-select-dropdown',\n  styleUrl: 'multi-select-dropdown.scss',\n  shadow: true,\n})\nexport class MultiSelectDropdown {\n  @Element() el!: HTMLElement;\n\n  // Props\n  /**\n   * The name of the dropdown\n   */\n  @Prop() name!: string;\n\n  /**\n   * The label of the dropdown\n   */\n  @Prop() label?: string;\n\n  /**\n   * The options to display in the dropdown\n   */\n  @Prop() options: DropdownOption[] = [];\n\n  // States\n  /**\n   * The copy of the options to display in the dropdown\n   */\n  @State() availableOptions: DropdownOption[] = this.options;\n  /**\n   * The open state of the dropdown\n   */\n  @State() isOpen: boolean = false;\n  /**\n   * The aria-activedescendant attribute for the listbox element to indicate the currently active\n   */\n  @State() ariaActivedescendant: string = '';\n\n  /**\n   * This flag is used to focus the first option when the dropdown is opened\n   * and reset after the first option is focused\n   */\n  @State() shouldFocusFirstOption: boolean = false;\n\n  // Events\n  /**\n   * This event is fired when the selected options are changed\n   */\n  @Event({ bubbles: true, composed: true }) selectedOptionsChanged!: EventEmitter<{\n    value: string[];\n    name: string;\n  }>;\n\n  // Lifecycle methods\n  componentDidRender() {\n    debug('multi-select-dropdown', 'componentDidRender');\n    if (this.isOpen && this.shouldFocusFirstOption) {\n      // The dropdown is open and we should focus the first option\n      this.ariaActivedescendant = this.availableOptions[0].value;\n      this.focusOption(0);\n      // Reset the flag\n      this.shouldFocusFirstOption = false;\n    }\n  }\n\n  // Event listeners\n  @Listen('click', { target: 'document', capture: true })\n  handleOutsideClick(event: MouseEvent) {\n    // Get the path of the event\n    const path = event.composedPath();\n\n    // Check if the path includes the host element\n    const isClickInside = path.includes(this.el);\n\n    if (!isClickInside && this.isOpen) {\n      this.isOpen = false;\n    }\n  }\n\n  // Methods\n\n  selectOption(option: DropdownOption): void {\n    this.availableOptions = this.availableOptions.map(o => {\n      if (o.value === option.value) {\n        o.selected = option.selected ? false : true;\n      }\n      return o;\n    });\n    const selectedOptions = this.availableOptions.filter(o => o.selected).map(o => o.value);\n    this.selectedOptionsChanged.emit({\n      value: selectedOptions,\n      name: this.name,\n    });\n  }\n\n  toggleDropdown(): void {\n    this.isOpen = !this.isOpen;\n    if (this.isOpen) {\n      this.shouldFocusFirstOption = true;\n    } else {\n      this.ariaActivedescendant = '';\n    }\n  }\n\n  handleSelectButtonKeyDown(event: KeyboardEvent): void {\n    switch (event.key) {\n      case 'ArrowDown':\n      case 'Enter':\n        event.preventDefault();\n        if (!this.isOpen) {\n          this.toggleDropdown();\n        }\n        break;\n      case 'Escape':\n        this.isOpen = false;\n        break;\n    }\n  }\n\n  handleListboxKeydown(e: KeyboardEvent) {\n    const items = this.availableOptions;\n    const currentIndex = items.findIndex(item => item.value === this.ariaActivedescendant);\n\n    switch (e.key) {\n      case 'ArrowDown':\n      case 'Tab':\n        if (!e.shiftKey) {\n          e.preventDefault();\n          const nextIndex = currentIndex + 1 < items.length ? currentIndex + 1 : 0;\n          this.ariaActivedescendant = items[nextIndex].value;\n          this.focusOption(nextIndex);\n        } else {\n          e.preventDefault();\n          const prevIndex = currentIndex - 1 >= 0 ? currentIndex - 1 : items.length - 1;\n          this.ariaActivedescendant = items[prevIndex].value;\n          this.focusOption(prevIndex);\n        }\n        break;\n      case 'ArrowUp':\n        e.preventDefault();\n        const prevIndex = currentIndex - 1 >= 0 ? currentIndex - 1 : items.length - 1;\n        this.ariaActivedescendant = items[prevIndex].value;\n        this.focusOption(prevIndex);\n        break;\n      case 'Enter':\n        e.preventDefault();\n        if (this.ariaActivedescendant) {\n          this.selectOption(items[currentIndex]);\n        }\n        break;\n      case 'Escape':\n        this.isOpen = false;\n        break;\n    }\n  }\n\n  focusOption(index: number) {\n    const option = this.availableOptions[index];\n    if (!option) return; // Guard clause in case index is out of bounds\n\n    const elementId = option.value;\n    const element = this.el.shadowRoot?.getElementById(elementId) as HTMLLIElement;\n\n    if (element) {\n      element.focus(); // Set focus on the element\n      element.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\n    }\n  }\n\n  getSelectedOptions() {\n    return this.availableOptions.filter(option => option.selected);\n  }\n\n  renderOption(option: DropdownOption) {\n    return (\n      <li\n        key={option.value}\n        id={option.value}\n        role=\"option\"\n        tabindex=\"0\"\n        aria-selected={option.selected ? 'true' : 'false'}\n        onClick={e => {\n          e.stopImmediatePropagation();\n          this.selectOption(option);\n        }}\n        class={{ selected: !!option.selected }}\n      >\n        <label htmlFor={option.value}>\n          <input aria-hidden=\"true\" id={option.value} type=\"checkbox\" checked={option.selected} />\n          <span>{option.label}</span>\n        </label>\n      </li>\n    );\n  }\n\n  render() {\n    return (\n      <Host>\n        <div class=\"dropdown\" part=\"msd_dropdown\">\n          <label class=\"dropdown-label\">\n            {this.label}\n            <slot name=\"label-icon\" aria-hidden=\"true\"></slot>\n          </label>\n          <button\n            part=\"msd_dropdown-button\"\n            class={{ dropbtn: true, open: this.isOpen }}\n            onClick={() => this.toggleDropdown()}\n            aria-haspopup=\"listbox\"\n            aria-expanded={this.isOpen ? 'true' : 'false'}\n            aria-label={this.name}\n            onKeyDown={e => this.handleSelectButtonKeyDown(e)}\n          >\n            <slot name=\"select-icon\" aria-hidden=\"true\"></slot>\n            <span class=\"selected-option\" part=\"msd_dropdown-button-selected-label\">\n              {this.getSelectedOptions().length > 1\n                ? `Multiple ${this.name}s selected`\n                : this.availableOptions.filter(o => o.selected)[0]?.label ?? this.availableOptions[0]?.label}\n            </span>\n            <span class={this.isOpen ? 'open' : 'closed'} aria-hidden=\"true\">\n              <chevron-icon width=\"16\" height=\"16\" />\n            </span>\n          </button>\n          {this.isOpen ? null : (\n            <div class={'selected-options'}>\n              {this.getSelectedOptions().map(option => (\n                <span class=\"selected-option\">\n                  {option.label}\n                  <button key={option.label} onClick={() => this.selectOption(option)}>\n                    <close-icon />\n                  </button>\n                </span>\n              ))}\n            </div>\n          )}\n          {this.isOpen ? (\n            <div class=\"dropdown-content\" part=\"msd_dropdown-content\">\n              <ul\n                tabindex=\"-1\"\n                role=\"listbox\"\n                aria-label={this.name}\n                aria-multiselectable={true}\n                aria-activedescendant={this.ariaActivedescendant}\n                onKeyDown={e => this.handleListboxKeydown(e)}\n              >\n                {this.availableOptions.map(option => this.renderOption(option))}\n              </ul>\n            </div>\n          ) : null}\n        </div>\n      </Host>\n    );\n  }\n}\n"],"version":3}